(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[565],{4963:function(e,t,r){Promise.resolve().then(r.bind(r,6282))},6282:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var n=r(7437),a=r(2265),s=r(2869),o=r(6070),i=r(5974),c=r(2449);let l=(0,r(9205).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var d=r(7648),u=r(4438),m=r(9116),f=r(4508),x=r(9376),h=r(3949),g=r(1595);function p(){let{t:e,i18n:t}=(0,h.$G)(),[r,p]=(0,a.useState)([]),[v,y]=(0,a.useState)([]),[b,j]=(0,a.useState)(!1),[w,N]=(0,a.useState)(!1),k=(0,x.useRouter)();(0,a.useEffect)(()=>{let e=localStorage.getItem("id");e&&p(JSON.parse(localStorage.getItem("cart")||"[]").filter(t=>t.userId===e))},[]),(0,a.useEffect)(()=>{j(!0)},[]);let C=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;return t?t.length<=r?t:t.slice(0,r)+"...":e("common.descriptionNotAvailable")},D=(e,t)=>{let r=t.target;"checkbox"===r.type||r.closest("button")||k.push("/book/".concat(e))},S=e=>{y(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},A=t=>{let n=r.filter(e=>e.id!==t);p(n),y(e=>e.filter(e=>e!==t)),localStorage.setItem("cart",JSON.stringify(n)),window.dispatchEvent(new Event("storage")),u.A.success(e("common.bookRemovedFromCart"))},_=async()=>{if(0===v.length){u.A.warning(e("common.selectAtLeastOneBook"));return}N(!0);let t=localStorage.getItem("id");if(!t){u.A.warning(e("common.loginRequired")),k.push("/login"),N(!1);return}try{let a=(await (0,m.uI)()).data||[];for(let s of v)if(a.some(e=>e.user_id===t&&e.book_id===s&&![6,8].includes(e.status_id))){var n;let t=(null===(n=r.find(e=>e.id===s))||void 0===n?void 0:n.name)||s;u.A.warning(e("common.bookAlreadyOrdered",{bookName:t})),N(!1);return}await Promise.all(v.map(async e=>{await (0,m.dR)(e)}));let s=r.filter(e=>!v.includes(e.id));p(s),y([]),localStorage.setItem("cart",JSON.stringify(s)),window.dispatchEvent(new Event("storage")),u.A.success(e("common.orderPlacedSuccessfully"))}catch(t){console.error("Buyurtma berishda yoki buyurtmalarni tekshirishda xatolik:",t),u.A.error(e("common.errorPlacingOrder"))}finally{N(!1)}};return b?0===r.length?(0,n.jsx)("div",{className:"container mx-auto px-4 py-8 mt-10",children:(0,n.jsxs)("div",{className:"text-center animate-fade-in",children:[(0,n.jsx)(c.Z,{className:"h-24 w-24 mx-auto mb-4 text-muted-foreground"}),(0,n.jsx)("h1",{className:"text-3xl font-bold mb-2 text-[#21466D]",children:e("common.cartEmpty")}),(0,n.jsx)("p",{className:"text-muted-foreground mb-8",children:e("common.noBooksInCart")}),(0,n.jsx)(d.default,{href:"/",children:(0,n.jsx)(g.Z,{children:(0,n.jsx)(s.z,{className:"bg-[#21466D] text-white hover:bg-[#21466D]/90",children:e("common.viewBooks")})})})]})}):(0,n.jsxs)("div",{className:"container mx-auto px-4 py-8 mt-10",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-[#21466D]",children:e("common.cart")}),(0,n.jsxs)("div",{className:"flex justify-center items-center gap-5 p-5",children:[(0,n.jsx)("input",{type:"checkbox",checked:v.length===r.length,onChange:()=>{v.length===r.length?y([]):y(r.map(e=>e.id))},className:"accent-[#21466D] w-5 h-5"}),(0,n.jsx)("p",{className:"text-sm text-[#21466D]",children:e("common.selectAll")})]})]}),(0,n.jsx)("div",{className:"flex gap-2",children:(0,n.jsx)(g.Z,{children:(0,n.jsx)(s.z,{variant:"destructive",onClick:()=>{p([]),y([]),localStorage.setItem("cart",JSON.stringify([])),window.dispatchEvent(new Event("storage")),u.A.success(e("common.cartCleared"))},children:e("common.clearCart")})})})]}),(0,n.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[(0,n.jsx)("div",{className:"lg:col-span-2 space-y-4",children:r.map((r,a)=>{var c,d,u;return(0,n.jsx)(o.Zb,{className:"animate-slide-up p-4 cursor-pointer hover:shadow-lg transition-all duration-200 hover:border-[#21466D]/20",style:{animationDelay:"".concat(.1*a,"s")},onClick:e=>D(r.id,e),children:(0,n.jsxs)("div",{className:"flex gap-4 flex-col sm:flex-row",children:[" ",(0,n.jsx)("input",{type:"checkbox",checked:v.includes(r.id),onChange:()=>S(r.id),className:"mt-2 accent-[#21466D] w-5 h-5 self-start sm:self-auto",onClick:e=>e.stopPropagation()}),(0,n.jsxs)("div",{className:"w-full sm:w-28 h-40 flex-shrink-0",children:[" ",(0,n.jsx)("img",{src:(0,f.hA)(null===(c=r.image)||void 0===c?void 0:c.url)||"/placeholder.svg",alt:r.name,className:"w-full h-full object-cover rounded"})]}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h3",{className:"font-semibold text-xl mb-2 text-[#21466D] hover:text-[#21466D]/80 transition-colors",children:r.name}),(0,n.jsx)("p",{className:"text-sm text-gray-600 mb-1 cursor-pointer",title:r.description||e("common.descriptionNotAvailable"),children:C(r.description)}),(0,n.jsxs)("div",{className:"space-y-1 text-sm text-muted-foreground mb-4",children:[(0,n.jsxs)("p",{children:[r.page," ",e("common.page")]}),(0,n.jsxs)("p",{children:[r.year,"-",e("common.year")]}),(0,n.jsxs)("p",{className:"text-xs text-[#21466D]",children:[e("common.author"),": ",(null===(d=r.Auther)||void 0===d?void 0:d.name)||e("common.unknown")]}),(null===(u=r.bookItem)||void 0===u?void 0:u.BookCategoryKafedra)&&(0,n.jsxs)("div",{className:"flex flex-wrap gap-1 mt-2",children:[(0,n.jsx)(i.C,{variant:"secondary",className:"text-xs bg-[#21466D]/10 text-[#21466D]",children:r.bookItem.BookCategoryKafedra.category["name_".concat(t.language.slice(0,2))]}),(0,n.jsx)(i.C,{variant:"outline",className:"text-xs border-[#21466D]/20 text-[#21466D]",children:r.bookItem.BookCategoryKafedra.kafedra["name_".concat(t.language.slice(0,2))]})]})]})]}),(0,n.jsx)(s.z,{variant:"outline",size:"icon",onClick:e=>{e.stopPropagation(),A(r.id)},className:"text-destructive hover:text-destructive self-end sm:self-auto",children:(0,n.jsx)(l,{className:"h-4 w-4"})})]})},r.id)})}),(0,n.jsx)("div",{className:"lg:col-span-1",children:(0,n.jsxs)(o.Zb,{className:"sticky top-28 animate-scale-in",children:[(0,n.jsx)(o.Ol,{children:(0,n.jsx)(o.ll,{children:e("common.orderSummary")})}),(0,n.jsxs)(o.aY,{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsxs)("span",{children:[e("common.selectedBooks"),":"]}),(0,n.jsxs)("span",{className:"font-semibold",children:[v.length," ",e("common.countUnit")]})]}),(0,n.jsx)("div",{className:"border-t pt-4",children:(0,n.jsx)(g.Z,{className:"w-full",children:(0,n.jsx)(s.z,{onClick:_,disabled:w||0===v.length,className:"px-8 py-6 w-full text-white hover:!bg-white hover:text-[#21466D]",style:{border:"1px solid",backgroundColor:"#21466D"},children:w?e("common.placingOrder"):e("common.placeOrder")})})})]})]})})]})]}):null}},1595:function(e,t,r){"use strict";var n=r(7437),a=r(2265);t.Z=e=>{let{children:t,className:r=""}=e,s=(0,a.useRef)(null),[o,i]=(0,a.useState)({x:0,y:0});return(0,a.useEffect)(()=>{let e=e=>{if(!s.current)return;let{left:t,top:r,width:n,height:a}=s.current.getBoundingClientRect(),o=t+n/5,c=r+a/5,l=Math.abs(o-e.clientX),d=Math.abs(c-e.clientY);l<n/2+25&&d<a/2+25?i({x:(e.clientX-o)/12,y:(e.clientY-c)/12}):i({x:0,y:0})};return window.addEventListener("mousemove",e),()=>window.removeEventListener("mousemove",e)},[]),(0,n.jsx)("div",{ref:s,style:{display:"inline-block",transform:"translate3d(".concat(o.x,"px, ").concat(o.y,"px, 0)"),transition:"transform 0.2s ease-out",willChange:"transform"},className:r,children:t})}},5974:function(e,t,r){"use strict";r.d(t,{C:function(){return i}});var n=r(7437);r(2265);var a=r(535),s=r(4508);let o=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:r,...a}=e;return(0,n.jsx)("div",{className:(0,s.cn)(o({variant:r}),t),...a})}},2869:function(e,t,r){"use strict";r.d(t,{d:function(){return c},z:function(){return l}});var n=r(7437),a=r(2265),s=r(7053),o=r(535),i=r(4508);let c=(0,o.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=a.forwardRef((e,t)=>{let{className:r,variant:a,size:o,asChild:l=!1,...d}=e,u=l?s.g7:"button";return(0,n.jsx)(u,{className:(0,i.cn)(c({variant:a,size:o,className:r})),ref:t,...d})});l.displayName="Button"},6070:function(e,t,r){"use strict";r.d(t,{Ol:function(){return i},Zb:function(){return o},aY:function(){return l},eW:function(){return d},ll:function(){return c}});var n=r(7437),a=r(2265),s=r(4508);let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});o.displayName="Card";let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",r),...a})});i.displayName="CardHeader";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});c.displayName="CardTitle",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",r),...a})}).displayName="CardDescription";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",r),...a})});l.displayName="CardContent";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",r),...a})});d.displayName="CardFooter"},9116:function(e,t,r){"use strict";r.d(t,{CP:function(){return s},bI:function(){return i},dR:function(){return u},nF:function(){return l},so:function(){return o},uI:function(){return d},x4:function(){return a},yZ:function(){return c}});let n=r(3464).Z.create({baseURL:"".concat("https://kutubxonaapi.usat.uz/api","/website"),headers:{"Content-Type":"application/json"}}),a=async(e,t)=>(await n.post("/login",{passport_id:e,password:t})).data,s=async()=>await n.get("/categories"),o=async()=>await n.get("/kafedras"),i=async()=>(await n.get("/book-items")).data,c=async()=>(await n.get("/book-items")).data,l=async()=>(await n.get("/books")).data,d=async()=>{let e=await n.get("/alluser-order");return console.log("orders",e),e.data},u=async e=>{let t=localStorage.getItem("id");return(await n.post("/user-order",{user_id:t,book_id:e})).data}},4508:function(e,t,r){"use strict";r.d(t,{cn:function(){return s},hA:function(){return o},xc:function(){return i}});var n=r(1994),a=r(3335);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,n.W)(t))}let o=e=>{let t="https://kutubxonaapi.usat.uz/api".replace("/api","")||"";return e?"".concat(t).concat(e):"/placeholder.svg"},i=e=>{let t=new Date(e),r=new Date;return r.setMonth(r.getMonth()-6),t>r}},2449:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9205).Z)("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]])}},function(e){e.O(0,[487,648,971,117,744],function(){return e(e.s=4963)}),_N_E=e.O()}]);